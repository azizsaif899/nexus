# ๐ ุงููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ ูุฎุงุฑุทุฉ ุงูุทุฑูู ุงูุงุณุชุฑุงุชูุฌูุฉ

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-07-24
**ุฅุตุฏุงุฑ ุงููุฑุงุฌุนุฉ:** 1.0

## 1. ููุฎุต ุชูููุฐู

ููุฏ ุงูุชููุช ุจูุฌุงุญ ุงููุฑุงุญู ุงูุซูุงุซ ุงูุฃููู ูู ุฎุทุฉ ุงูุชุฑุญูู. ุชู ุชุญููู ุงููุดุฑูุน ุจุงููุงูู ุฅูู ุจููุฉ ES6 ุญุฏูุซุฉ ููุธููุฉุ ูุชู ุชูุธูู ุงููููู ุงููุฏูู. ุงููุดุฑูุน ุงูุขู ูู ุญุงูุฉ ููุชุงุฒุฉ ูู ุญูุซ ุงูุชูุธููุ ููููู ููุงุฌู **ูุฎุงุทุฑ ุญุฑุฌุฉ** ุชููุนู ูู ุงูุนูู ุจุดูู ุตุญูุญ ูู ุจูุฆุฉ Node.js.

ูุฐุง ุงูุชูุฑูุฑ ูุญุฏุฏ ูุฐู ุงููุฎุงุทุฑ ูููุฏู ุฎุงุฑุทุฉ ุทุฑูู ูุงุถุญุฉ ููุนุงูุฌุชูุง ูู ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ.

---

## 2. ุชุญููู ุงููุฎุงุทุฑ ุงูุญุฑุฌุฉ

### ๐ด ุงูุฎุทุฑ ุฑูู 1: ุงูุชุจุนูุงุช ุงูุฏุงุฆุฑูุฉ ูุงูุชูููุฐ ุนูู ูุณุชูู ุงููุญุฏุฉ (Circular Dependencies & Top-Level Execution)

**ุงููุดููุฉ:** ูุฐู ูู ุงููุดููุฉ ุงูุฃูุซุฑ ุฎุทูุฑุฉ ูู ุงููุดุฑูุน ุญุงูููุง. ุงูุนุฏูุฏ ูู ุงููุญุฏุงุช (ูุซู `Telemetry.js`, `ErrorLogger.js`) ุชููู ุจุงุณุชุฏุนุงุก `Config.get()` ูู ุงููุณุชูู ุงูุฃุนูู ูู ุงูููู (Top-Level). ูู ุจูุฆุฉ Node.jsุ ูุฐุง ูุคุฏู ุฅูู "ุณุจุงู ุชุญููู" ุญูุซ ูุฏ ุชุญุงูู ูุญุฏุฉ ุงุณุชูุฑุงุฏ ูุญุฏุฉ ุฃุฎุฑู ูู ุชูุชูู ุนูููุฉ ุชุตุฏูุฑูุง ุจุนุฏุ ููุง ูุคุฏู ุฅูู ุฃุฎุทุงุก `TypeError: ... is not a function` ุฃู ุงูุญุตูู ุนูู ูุงุฆูุงุช ูุงุฑุบุฉ (`{}`).

**ุงูุฏููู:** ุชู ุงูุชุดุงู ุชุจุนูุฉ ุฏุงุฆุฑูุฉ ูุจุงุดุฑุฉ:
1.  `Utils.js` ูุณุชูุฑุฏ `ErrorLogger.js` ูุงุณุชุฎุฏุงูู ูู ุฏุงูุฉ `error`.
2.  `ErrorLogger.js` ูุณุชูุฑุฏ `Utils.js` ูุงุณุชุฎุฏุงูู ูู ุฏูุงู ุงูุชุณุฌูู.

ูุฐุง ุณูุคุฏู ุฅูู ูุดู ุงููุธุงู ุนูุฏ ูุญุงููุฉ ุชุดุบููู ูู Node.js.

**ุงูุชูุตูุฉ (ุนุงููุฉ ุงูุฃููููุฉ):**
*   **ุฅุนุงุฏุฉ ููููุฉ ุชุญููู ุงูุฅุนุฏุงุฏุงุช:** ูุฌุจ ุฃูุง ุชููู ุงููุญุฏุงุช ุจุชูููุฐ ุฃู ููุฏ ูุนุชูุฏ ุนูู ูุญุฏุงุช ุฃุฎุฑู ูู ุงููุณุชูู ุงูุฃุนูู. ูุฌุจ ุฃู ูุชู ุชุญููู ุงูุฅุนุฏุงุฏุงุช ูู ููุทุฉ ุฏุฎูู ูุงุญุฏุฉ (`src/index.js`)ุ ุซู ูุชู ุชูุฑูุฑ ูุงุฆู ุงูุฅุนุฏุงุฏุงุช ุฅูู ุงููุญุฏุงุช ุงูุชู ุชุญุชุงุฌูุ ุฅูุง ุนุจุฑ ุฏุงูุฉ `init(config)` ุฃู ุนุจุฑ ุงููููุดุฆ (constructor) ุฅุฐุง ูููุง ุจุชุญููููุง ุฅูู ูุฆุงุช (classes).
*   **ูุณุฑ ุงูุชุจุนูุฉ ุงูุฏุงุฆุฑูุฉ:** ูุฌุจ ูุตู `ErrorLogger` ุนู `Utils`. ูููู ูู `Utils.error` ุฃู ูููู ููุท ุจุฅุตุฏุงุฑ ุญุฏุซ (event)ุ ูุชููู ูุญุฏุฉ `ErrorLogger` ุจุงูุงุณุชูุงุน ููุฐุง ุงูุญุฏุซ ูุชุณุฌููู.

### ๐ก ุงูุฎุทุฑ ุฑูู 2: ุงูุงูุชุฑุงู ุงูุดุฏูุฏ ุจุฎุฏูุงุช Google Apps Script (Tight Coupling to GAS Globals)

**ุงููุดููุฉ:** ุนูู ุงูุฑุบู ูู ุฃููุง ุฃูุดุฃูุง ุจูุฆุฉ ูุญุงูุงุฉ (`gas-mocks.js`)ุ ุฅูุง ุฃู ุงูููุฏ ุงููุตุฏุฑู ููุณู ูุง ูุฒุงู ูุนุชูุฏ ุจุดูู ูุจุงุดุฑ ุนูู ูุฌูุฏ ูุงุฆูุงุช ุนุงูุฉ ูุซู `SpreadsheetApp` ู `DriveApp`. ูุฐุง ูุฌุนู ุงูููุฏ ุตุนุจ ุงูุงุฎุชุจุงุฑ ุจุดูู ูุนุฒูู ููููุฏู ุจุจูุฆุฉ Apps Script ุฃู ุจูุฆุฉ ุงููุญุงูุงุฉ.

**ุงูุชูุตูุฉ (ูุชูุณุทุฉ ุงูุฃููููุฉ):**
*   **ุชุทุจูู ุญูู ุงูุชุจุนูุฉ (Dependency Injection):** ุนูู ุงููุฏู ุงูุทูููุ ูุฌุจ ุชุนุฏูู ุงููุญุฏุงุช ูุชุชููู ุฎุฏูุงุช ูุซู `SpreadsheetApp` ููุนุงูู (parameter) ุจุฏูุงู ูู ุงุณุชุฏุนุงุฆูุง ุจุดูู ุนุงู. ูุฐุง ูุณูุญ ููุง ุจุชูุฑูุฑ ุงููุงุฆู ุงูุญูููู ูู ุจูุฆุฉ ุงูุฅูุชุงุฌุ ูุชูุฑูุฑ ูุงุฆู ูููู ูู ุจูุฆุฉ ุงูุงุฎุชุจุงุฑ ุจุณูููุฉ.

---

## 3. ููุงุญุธุงุช ุญูู ุฌูุฏุฉ ุงูููุฏ

*   **ุชูุงุณู ุงููููู:** ููุงู ุจุนุถ ุนุฏู ุงูุชูุงุณู ูู ูููู ุงููุฌูุฏุงุช. ุนูู ุณุจูู ุงููุซุงูุ ุจุนุถ ุงููููุงุช ููุฌูุฏุฉ ูุจุงุดุฑุฉ ูู `src/` (ูุซู `ToolsCodeReview.js`) ุจูููุง ูุฌุจ ุฃู ุชููู ุฏุงุฎู ูุฌูุฏุงุช ูุชุฎุตุตุฉ (ูุซู `src/Tools/`).
*   **ุฃูุงู ุฏุงูุฉ `sanitize`:** ุงูุฏุงูุฉ `sanitize` ูู ูุญุฏุฉ `Security.js` ุฃุณุงุณูุฉ ุฌุฏูุง. ูุฌุจ ุงุณุชุจุฏุงููุง ุจููุชุจุฉ ุฃูุซุฑ ููุฉ ูููุซูููุฉ ููุนุงูุฌุฉ ุงููุฏุฎูุงุช ุฅุฐุง ูุงู ุณูุชู ุงูุชุนุงูู ูุน ูุฏุฎูุงุช ุญุณุงุณุฉ.

---

## 4. ุฎุงุฑุทุฉ ุงูุทุฑูู ุงูููุชุฑุญุฉ ูููุฑุญูุฉ ุงูุฑุงุจุนุฉ

ูุถูุงู ูุฌุงุญ ุงููุดุฑูุนุ ูุฌุจ ุฃู ูุชุจุน ุงูุฎุทูุงุช ุงูุชุงููุฉ ุจุงูุชุฑุชูุจ:

1.  **ุฅูุดุงุก ููุทุฉ ุฏุฎูู ุฑุฆูุณูุฉ (`src/index.js`):** ุฅูุดุงุก ููู ุฑุฆูุณู ูููู ูุณุคููุงู ุนู ุชููุฆุฉ ุงููุธุงู ุจุฃูููู.
2.  **ุฅุนุงุฏุฉ ููููุฉ ุชุญููู ุงูุฅุนุฏุงุฏุงุช:** ุชุนุฏูู ูุญุฏุฉ `Config.js` ูุชููู ุจุชุญููู ุงูุฅุนุฏุงุฏุงุช ุนูุฏ ุงุณุชุฏุนุงุฆูุงุ ูููุณ ุนูุฏ ุงุณุชูุฑุงุฏูุง. ุณุชููู `src/index.js` ุจุงุณุชุฏุนุงุก ูุฐู ุงููุธููุฉ ุฃููุงู.
3.  **ูุณุฑ ุงูุชุจุนูุงุช ุงูุฏุงุฆุฑูุฉ:** ุชุนุฏูู `Utils.js` ู `ErrorLogger.js` ููุตู ุงุนุชูุงุฏููุง ุนูู ุจุนุถููุง ุงูุจุนุถ.
4.  **ุฅุตูุงุญ ุงุฎุชุจุงุฑ ุงูุชูุงูู:** ุจุนุฏ ุญู ุงููุดุงูู ุงูุณุงุจูุฉุ ุณูููู ุจุฅุตูุงุญ ูุชุดุบูู `node_integration_test_runner.js` ุจูุฌุงุญ.
5.  **ุฃุชูุชุฉ ุงูุชูุซูู:** ุฅุนุฏุงุฏ ูุธุงู `jsdoc2md` ูุชูููุฏ ุชูุซูู ุงุญุชุฑุงูู ูู ุงูููุฏ ุงููุตุฏุฑู ูู `src/`.
6.  **ุงูุชุญูู ุงูููุงุฆู:** ุชุดุบูู ุงูุชุทุจูู ุจุงููุงูู ูู ุฎูุงู `node src/index.js` ููุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู ููุง ูู ูุชููุน.

---

## 5. ุฎุงุฑุทุฉ ุงูุทุฑูู ูููุฑุญูุฉ ุงูุฎุงูุณุฉ: ุชุญุณูู ุงููููููุฉ ููุงุจููุฉ ุงูุตูุงูุฉ (Barrel File Architecture)

ุจุนุฏ ุงุณุชูุฑุงุฑ ุงููุธุงู ูู ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉุ ุชุฑูุฒ ูุฐู ุงููุฑุญูุฉ ุนูู ุชุญุณูู ุงูุจููุฉ ุงููุนูุงุฑูุฉ ูุชุณููู ุงูุงุณุชูุฑุงุฏ ูุฌุนู ุงููุดุฑูุน ุฃูุซุฑ ูุงุจููุฉ ููุตูุงูุฉ ุนูู ุงููุฏู ุงูุทููู.

### ๐ฏ ุงููุฏู

ุชุทุจูู ููุท "ุงููููุงุช ุงูุจุฑููููุฉ" (Barrel Files) ุนู ุทุฑูู ุฅูุดุงุก ููู `index.js` ูู ูู ูุฌูุฏ ุฑุฆูุณู ุฏุงุฎู `src/`. ูุฐุง ุงูููู ุณูุนูู ูููุทุฉ ุฏุฎูู ููุญุฏุฉ ูููุญุฏุฉุ ุญูุซ ูููู ุจุชุฌููุน ูุฅุนุงุฏุฉ ุชุตุฏูุฑ ุฌููุน ุงููุญุฏุงุช ุงููุฑุนูุฉ.

**ูุซุงู:** ุจุฏูุงู ูู ุงุณุชูุฑุงุฏ `import { Sheets } from '../Tools/Sheets.js'`ุ ุณูุตุจุญ ุงูุงุณุชูุฑุงุฏ ุฃุจุณุท ูุฃูุซุฑ ูุฑููุฉ: `import { Sheets } from '../Tools';`.

### ๐๏ธ ุงูุขููุฉ

1.  **ุฅูุดุงุก ุณูุฑุจุช ุฃุชูุชุฉ:** ุณูุชู ุฅูุดุงุก ุณูุฑุจุช ุฌุฏูุฏ `src/dev_tools/generate-indices.js` ูููู ุจุงูุขุชู:
    -   ููุญุต ุฌููุน ุงููุฌูุฏุงุช ุฏุงุฎู `src/` ุจุดูู ัะตะบัััะธะฒะฝัะน.
    -   ููุดุฆ ููู `index.js` ูู ูู ูุฌูุฏ ูุญุชูู ุนูู ูููุงุช JavaScript.
    -   ูุถูู ุฌูู `export * from './module.js';` ููู ููู ูู ุงููุฌูุฏ.

2.  **ุฅุถุงูุฉ ุฃูุฑ ูุฎุตุต:** ุณูุชู ุฅุถุงูุฉ ุฃูุฑ ุฌุฏูุฏ ุฅูู `package.json` ูุชุณููู ุชุดุบูู ุงูุณูุฑุจุช:
    ```json
    "scripts": {
      "index:generate": "node src/dev_tools/generate-indices.js"
    }
    ```

3.  **ุงูุชูุงูู ูุน ุณูุฑ ุงูุนูู (Husky):** ุณูุชู ุชุญุฏูุซ `pre-commit` hook ููุดุบู ูุฐุง ุงูุณูุฑุจุช ุชููุงุฆููุง ูุจู ูู ุนูููุฉ `commit`ุ ููุง ูุถูู ุจูุงุก ุงููููู ููุธููุง ููุญุฏุซูุง ุฏุงุฆููุง.