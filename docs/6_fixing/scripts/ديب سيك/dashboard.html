<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” DeepSeek AI Dashboard v3.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #4a5568;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #718096;
            font-size: 1.2em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #718096;
            font-size: 1.1em;
        }

        .critical { color: #e53e3e; }
        .high { color: #dd6b20; }
        .medium { color: #d69e2e; }
        .low { color: #38a169; }
        .info { color: #3182ce; }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .panel h2 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-scan { background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%); }
        .btn-fix { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); }
        .btn-quick { background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%); }
        .btn-reports { background: linear-gradient(135deg, #9f7aea 0%, #805ad5 100%); }

        .report-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .report-item {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .report-item:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
        }

        .report-title {
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 5px;
        }

        .report-meta {
            color: #718096;
            font-size: 0.9em;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 10px;
        }

        .status-running { background: #ed8936; }
        .status-completed { background: #38a169; }
        .status-error { background: #e53e3e; }

        .progress-bar {
            background: #e2e8f0;
            border-radius: 10px;
            height: 20px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #48bb78, #38a169);
            height: 100%;
            transition: width 0.3s ease;
        }

        .log-viewer {
            background: #1a202c;
            color: #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 30px;
            padding: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ” DeepSeek AI Dashboard v3.0</h1>
            <p>Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ­Øµ ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„ÙƒÙˆØ¯</p>
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ”</div>
                <div class="stat-number critical" id="criticalCount">-</div>
                <div class="stat-label">Ù…Ø´Ø§ÙƒÙ„ Ø­Ø±Ø¬Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">âš ï¸</div>
                <div class="stat-number high" id="highCount">-</div>
                <div class="stat-label">Ù…Ø´Ø§ÙƒÙ„ Ø¹Ø§Ù„ÙŠØ©</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">âš¡</div>
                <div class="stat-number medium" id="mediumCount">-</div>
                <div class="stat-label">Ù…Ø´Ø§ÙƒÙ„ Ù…ØªÙˆØ³Ø·Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">âœ…</div>
                <div class="stat-number low" id="lowCount">-</div>
                <div class="stat-label">Ù…Ø´Ø§ÙƒÙ„ Ù…Ù†Ø®ÙØ¶Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-number info" id="complianceScore">-</div>
                <div class="stat-label">Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“</div>
                <div class="stat-number info" id="filesScanned">-</div>
                <div class="stat-label">Ù…Ù„ÙØ§Øª Ù…ÙØ­ÙˆØµØ©</div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="btn btn-scan" onclick="runFullScan()">ğŸ” ÙØ­Øµ Ø´Ø§Ù…Ù„</button>
            <button class="btn btn-fix" onclick="runAutoFix()">ğŸ”§ Ø¥ØµÙ„Ø§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
            <button class="btn btn-quick" onclick="runQuickScan()">âš¡ ÙØ­Øµ Ø³Ø±ÙŠØ¹</button>
            <button class="btn btn-reports" onclick="refreshReports()">ğŸ“Š ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
            <button class="btn" onclick="toggleHelp()">ğŸ“– Ù…Ø³Ø§Ø¹Ø¯Ø©</button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Reports Panel -->
            <div class="panel">
                <h2>ğŸ“‹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø®ÙŠØ±Ø©</h2>
                <div class="report-list" id="reportsList">
                    <div class="report-item">
                        <div class="report-title">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ±</div>
                        <div class="report-meta">Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ ÙØ­Øµ Ø£ÙˆÙ„Ø§Ù‹</div>
                    </div>
                </div>
            </div>

            <!-- System Status -->
            <div class="panel">
                <h2>âš™ï¸ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                <div>
                    <p>ğŸ Python: <span class="status-indicator status-completed"></span> Ù…ØªÙˆÙØ±</p>
                    <p>ğŸ“¦ Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©: <span class="status-indicator" id="venvStatus"></span> <span id="venvText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</span></p>
                    <p>ğŸ“Š Ø¢Ø®Ø± ÙØ­Øµ: <span id="lastScanTime">-</span></p>
                    <p>ğŸ”§ Ø¢Ø®Ø± Ø¥ØµÙ„Ø§Ø­: <span id="lastFixTime">-</span></p>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="systemHealth" style="width: 0%"></div>
                </div>
                <p style="text-align: center; margin-top: 10px;">ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…: <span id="healthPercent">0%</span></p>
            </div>
        </div>

        <!-- Log Viewer -->
        <div class="panel">
            <h2>ğŸ“ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h2>
            <div class="log-viewer" id="logViewer">
                <div>ğŸš€ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ DeepSeek AI Dashboard v3.0</div>
                <div>ğŸ“Š Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
            </div>
        </div>

        <!-- Help Panel (Hidden by default) -->
        <div class="panel" id="helpPanel" style="display: none;">
            <h2>ğŸ“– Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h2>
            <div style="max-height: 400px; overflow-y: auto;">
                <h3>ğŸš€ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹:</h3>
                <p>1. ØªØ´ØºÙŠÙ„ DEEPSEEK_MASTER.bat</p>
                <p>2. Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø®ÙŠØ§Ø± 6 Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø© (Ø£ÙˆÙ„ Ù…Ø±Ø©)</p>
                <p>3. Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø®ÙŠØ§Ø± 1 Ù„Ù„ÙØ­Øµ Ø§Ù„Ø´Ø§Ù…Ù„</p>
                <p>4. Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
                
                <h3>ğŸ“ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª:</h3>
                <p>â€¢ reports/ - ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ</p>
                <p>â€¢ fix_reports/ - ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥ØµÙ„Ø§Ø­</p>
                <p>â€¢ plans/ - Ø®Ø·Ø· Ø§Ù„Ø¥ØµÙ„Ø§Ø­</p>
                <p>â€¢ backups/ - Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</p>
                <p>â€¢ logs/ - Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</p>
                
                <h3>ğŸ” Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„:</h3>
                <p>ğŸ”´ Ø­Ø±Ø¬Ø©: eval, ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± Ù…ÙƒØ´ÙˆÙØ©, Ù…ÙØ§ØªÙŠØ­ API</p>
                <p>ğŸŸ  Ø¹Ø§Ù„ÙŠØ©: XSS, Ø­Ù‚Ù† Ø£ÙˆØ§Ù…Ø±</p>
                <p>ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø©: TODO, Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡</p>
                <p>ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø©: console.log, debugger</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Â© 2025 DeepSeek AI - Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ­Øµ ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø°ÙƒÙŠ</p>
            <p>ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© AzizSys AI Assistant</p>
        </div>
    </div>

    <script>
        // Global variables
        let currentData = null;
        let logMessages = [];

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            addLog('ğŸ¯ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…');
            checkSystemStatus();
            loadLatestReports();
            
            // Auto refresh every 30 seconds
            setInterval(loadLatestReports, 30000);
        });

        // Add log message
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            logMessages.push(`[${timestamp}] ${message}`);
            
            // Keep only last 50 messages
            if (logMessages.length > 50) {
                logMessages.shift();
            }
            
            updateLogViewer();
        }

        // Update log viewer
        function updateLogViewer() {
            const logViewer = document.getElementById('logViewer');
            logViewer.innerHTML = logMessages.map(msg => `<div>${msg}</div>`).join('');
            logViewer.scrollTop = logViewer.scrollHeight;
        }

        // Check system status
        function checkSystemStatus() {
            addLog('ğŸ” ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…...');
            
            // Check virtual environment
            fetch('deepseek_env/pyvenv.cfg')
                .then(response => {
                    if (response.ok) {
                        document.getElementById('venvStatus').className = 'status-indicator status-completed';
                        document.getElementById('venvText').textContent = 'Ø¬Ø§Ù‡Ø²';
                        updateSystemHealth(80);
                        addLog('âœ… Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¬Ø§Ù‡Ø²Ø©');
                    } else {
                        throw new Error('Virtual environment not found');
                    }
                })
                .catch(error => {
                    document.getElementById('venvStatus').className = 'status-indicator status-error';
                    document.getElementById('venvText').textContent = 'ØºÙŠØ± Ù…ØªÙˆÙØ±';
                    updateSystemHealth(30);
                    addLog('âŒ Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                });
        }

        // Update system health
        function updateSystemHealth(percentage) {
            document.getElementById('systemHealth').style.width = percentage + '%';
            document.getElementById('healthPercent').textContent = percentage + '%';
        }

        // Load latest reports
        function loadLatestReports() {
            addLog('ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±...');
            
            // Load scan reports
            loadReportsFromDirectory('reports', 'scan_report_', 'ÙØ­Øµ');
            
            // Load fix reports
            loadReportsFromDirectory('fix_reports', 'fix_report_', 'Ø¥ØµÙ„Ø§Ø­');
        }

        // Load reports from directory
        function loadReportsFromDirectory(directory, prefix, type) {
            // Since we can't directly access file system from browser,
            // we'll simulate loading the latest report
            const reportsList = document.getElementById('reportsList');
            
            // Try to load the latest scan report
            if (directory === 'reports') {
                loadLatestScanReport();
            }
        }

        // Load latest scan report
        function loadLatestScanReport() {
            // Try to find the latest scan report
            const reportFiles = [
                'reports/scan_report_1756826390069.json'
            ];
            
            reportFiles.forEach(reportFile => {
                fetch(reportFile)
                    .then(response => response.json())
                    .then(data => {
                        currentData = data;
                        updateStatistics(data);
                        updateReportsList(data, reportFile);
                        addLog(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ±: ${reportFile}`);
                    })
                    .catch(error => {
                        addLog(`âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙ‚Ø±ÙŠØ±: ${reportFile}`);
                    });
            });
        }

        // Update statistics
        function updateStatistics(data) {
            if (data.summary) {
                document.getElementById('criticalCount').textContent = data.summary.critical_issues || 0;
                document.getElementById('highCount').textContent = data.summary.high_issues || 0;
                document.getElementById('mediumCount').textContent = data.summary.medium_issues || 0;
                document.getElementById('lowCount').textContent = data.summary.low_issues || 0;
            }
            
            if (data.compliance) {
                document.getElementById('complianceScore').textContent = data.compliance.score || 0;
            }
            
            if (data.scan_info) {
                document.getElementById('filesScanned').textContent = data.scan_info.scanned_files || 0;
                document.getElementById('lastScanTime').textContent = 
                    new Date(data.scan_info.timestamp).toLocaleString('ar-SA');
            }
        }

        // Update reports list
        function updateReportsList(data, filename) {
            const reportsList = document.getElementById('reportsList');
            const reportItem = document.createElement('div');
            reportItem.className = 'report-item';
            reportItem.onclick = () => showReportDetails(data);
            
            const timestamp = data.scan_info ? new Date(data.scan_info.timestamp).toLocaleString('ar-SA') : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const totalIssues = data.summary ? data.summary.total_issues : 0;
            
            reportItem.innerHTML = `
                <div class="report-title">ØªÙ‚Ø±ÙŠØ± ÙØ­Øµ - ${totalIssues} Ù…Ø´ÙƒÙ„Ø©</div>
                <div class="report-meta">${timestamp} - ${filename}</div>
            `;
            
            reportsList.innerHTML = '';
            reportsList.appendChild(reportItem);
        }

        // Show report details
        function showReportDetails(data) {
            const details = `
ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±:
================
ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„: ${data.summary?.total_issues || 0}
ğŸ”´ Ø­Ø±Ø¬Ø©: ${data.summary?.critical_issues || 0}
ğŸŸ  Ø¹Ø§Ù„ÙŠØ©: ${data.summary?.high_issues || 0}
ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø©: ${data.summary?.medium_issues || 0}
ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø©: ${data.summary?.low_issues || 0}
ğŸ“ Ù…Ù„ÙØ§Øª Ù…ÙØ­ÙˆØµØ©: ${data.scan_info?.scanned_files || 0}
â±ï¸ Ù…Ø¯Ø© Ø§Ù„ÙØ­Øµ: ${data.scan_info?.scan_duration || 0} Ø«Ø§Ù†ÙŠØ©
ğŸ† Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„: ${data.compliance?.score || 0}/100
            `;
            
            // TODO: Replace alert with proper notification
        }

        // Run full scan
        function runFullScan() {
            addLog('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø´Ø§Ù…Ù„...');
            // TODO: Replace alert with proper notification
        }

        // Run auto fix
        function runAutoFix() {
            addLog('ğŸ”§ Ø¨Ø¯Ø¡ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ...');
            // TODO: Replace alert with proper notification
        }

        // Run quick scan
        function runQuickScan() {
            addLog('âš¡ Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø³Ø±ÙŠØ¹...');
            // TODO: Replace alert with proper notification
        }

        // Refresh reports
        function refreshReports() {
            addLog('ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±...');
            loadLatestReports();
        }

        // Toggle help panel
        function toggleHelp() {
            const helpPanel = document.getElementById('helpPanel');
            if (helpPanel.style.display === 'none') {
                helpPanel.style.display = 'block';
                addLog('ğŸ“– ÙØªØ­ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©');
            } else {
                helpPanel.style.display = 'none';
                addLog('ğŸ“– Ø¥ØºÙ„Ø§Ù‚ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©');
            }
        }
    </script>
</body>
</html>